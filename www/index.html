<script src="stockfish.js"></script>
<script>
  const { Chess } = require('./chess.js');
  chess = new Chess();
  
  Stockfish().then(sf => {
      sf.addMessageListener(line => {
	  console.log(line);
      });

      // internal function
      const p = (message) => {
	  sf.postMessage(message);
      };

      // external interface functions
      start = () => {
	  sf.postMessage("position startpos\n");
      }
      
      move = (m) => {
	  sf.postMessage("position startpos moves " + m + "\n");
	  sf.postMessage("go nodes 1000\n");
      }

      quit = () => {
	  sf.postMessage("quit\n");
      }

      // setup
      
      p("uci\n");
      p("setoption name Threads value 32\n");
      p("ucinewgame\n");
      p("setoption name UCI_AnalyseMode value true\n");
  });
</script>
